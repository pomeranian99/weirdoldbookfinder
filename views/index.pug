doctype strict
head
  meta(http-equiv='content-type' content='text/html; charset=utf-8')
  meta(name='viewport' content='width=device-width, initial-scale=1.0')
  title Weird Old Book Finder
  script(type='text/javascript' src='https://www.google.com/books/jsapi.js')
  link(href='https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css' rel='stylesheet' integrity='sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3' crossorigin='anonymous')
  link(rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css')
  link(rel="stylesheet" href="style.css")
  link(href="https://fonts.googleapis.com/css2?family=IM+Fell+English&display=swap" rel="stylesheet")

body
  .container
    .row
      h1 Weird Old Book Finder
    .row.formStuff
      <form method="POST" action="/">
      .form-group
        <div id="formGroup">
        <input type="text" class="textInput form-control w-50 p-3" id="inputdefault" maxlength="70" name="searchText" value="" placeholder="Type your query!" autofocus/>
        </div>
        </form> 

    .row
      #viewerCanvas
      #viewer
    
    #footer.row
      .footer
        p
          | [ made by 
          a(href='https://twitter.com/pomeranian99' target='_blank') clive
          |               | here&apos;s 
          a(href='https://clivethompson.medium.com/what-i-learned-about-my-writing-by-seeing-only-the-punctuation-efd5334060b1' target='_blank') why
          |                | 
          a(href='https://glitch.com/edit/#!/weird-old-book-finder?path=views%2Findex.pug%3A1%3A0') remix!
          |               ]


  script(src='https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js' integrity='sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p' crossorigin='anonymous')
  
  
// send in the clowns, sorry i mean the javascript
script(defer='').

  var theBook = "#{bookRetrieved}";
  var success = #{success};
  // for some reason having a semicolon after this next variable declaration
  // was causing an error in the browser? Who knows why, life is meaningless
  var errors = #{errors}
  console.log(success);
  console.log(theBook);
  
  // create an instance of the google books viewer
  google.books.load();
    
  function initialize() {
    var viewer = new google.books.DefaultViewer(
    document.getElementById("viewerCanvas")
    );
    // here's where we specify which book to display
    viewer.load(theBook);
  }
  
  google.books.setOnLoadCallback(initialize);
  
  if (!success && !errors){
    alert("Alas, we didn't find any books for that query. Try another!");
  }  
  
  if (success && errors) {
    alert("Sorry, you can only type alphanumeric search phrases. Letters and numbers only!");
  } 
   
  
  
  
  
  